fileVersion: 1
id: ac411644-aba8-4eca-a736-477f514914eb
name: PROFIT_CALCULATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Calculates profit margins for menu items
  isMultisource: false
  locationName: SAMPLE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72b86840-181a-45ad-809b-b2a075df5a96
          stepCounter: ac411644-aba8-4eca-a736-477f514914eb
        config: {}
        dataType: VARCHAR
        description: ""
        name: TRUCK_BRAND_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea4ea9bc-8448-4fb8-9b81-42dae41c96fd
                stepCounter: 92df3675-ad81-4a75-bf3e-17814a425674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef63b13f-d9bd-497c-9352-2378912115ca
          stepCounter: ac411644-aba8-4eca-a736-477f514914eb
        config: {}
        dataType: VARCHAR
        description: ""
        name: ITEM_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26f24f0e-ced3-45c6-8b75-24e203a9c1d0
                stepCounter: 92df3675-ad81-4a75-bf3e-17814a425674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b6cf883-e1cf-49f2-8fbd-ca0d13b56812
          stepCounter: ac411644-aba8-4eca-a736-477f514914eb
        config: {}
        dataType: VARCHAR
        description: ""
        name: MENU_ITEM_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfd04725-3bcc-4bb2-9fc6-d84f66832586
                stepCounter: 92df3675-ad81-4a75-bf3e-17814a425674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b6f2dbc-ffd3-4f21-9a27-df58d03e607a
          stepCounter: ac411644-aba8-4eca-a736-477f514914eb
        config: {}
        dataType: NUMBER
        description: ""
        name: PROFIT_MARGIN_USD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff54beed-ea26-41e4-a91f-1ecbc29d702d
                stepCounter: 92df3675-ad81-4a75-bf3e-17814a425674
            transform: ROUND(CURRENT_MENU.SALE_PRICE_USD - CURRENT_MENU.COST_OF_GOODS_USD, 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 428d928b-b33e-44e4-8ab3-f81d9b427b37
          stepCounter: ac411644-aba8-4eca-a736-477f514914eb
        config: {}
        dataType: NUMBER
        description: ""
        name: SALE_PRICE_USD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff54beed-ea26-41e4-a91f-1ecbc29d702d
                stepCounter: 92df3675-ad81-4a75-bf3e-17814a425674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9888e9f3-3c19-4bdb-a944-dc4bed18a310
          stepCounter: ac411644-aba8-4eca-a736-477f514914eb
        config: {}
        dataType: NUMBER
        description: ""
        name: COST_OF_GOODS_USD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0564b637-7b1e-4d89-b289-dc4425b7964f
                stepCounter: 92df3675-ad81-4a75-bf3e-17814a425674
            transform: ""
    cteString: ""
    description: ""
    destinationName: ""
    enabledColumnTestIDs: []
    materializationOption: ""
    sourceMapping:
      - aliases:
          CURRENT_MENU: 92df3675-ad81-4a75-bf3e-17814a425674
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SAMPLE
            nodeName: CURRENT_MENU
        join:
          joinCondition: |-
            FROM {{ ref('SAMPLE', 'CURRENT_MENU') }} CURRENT_MENU
            WHERE SALE_PRICE_USD IS NOT NULL 
              AND COST_OF_GOODS_USD IS NOT NULL
        name: PROFIT_CALCULATIONS
        noLinkRefs: []
  name: PROFIT_CALCULATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
